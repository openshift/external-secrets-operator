apiVersion: operator.openshift.io/v1alpha1
kind: ExternalSecretsConfig
metadata:
  labels:
    app.kubernetes.io/name: cluster
    app.kubernetes.io/managed-by: external-secrets-operator-e2e
  name: cluster
spec:
  controllerConfig:
    componentConfigs:
      - componentName: ExternalSecretsCoreController
        deploymentConfigs:
          revisionHistoryLimit: 3
      - componentName: Webhook
        deploymentConfigs:
          revisionHistoryLimit: 5
      - componentName: CertController
        deploymentConfigs:
          revisionHistoryLimit: 2
    networkPolicies:
      - name: allow-external-secrets-egress
        componentName: ExternalSecretsCoreController
        egress:
          # Allow egress to Kubernetes API server, AWS endpoints, and DNS
          - to: []
            ports:
            - protocol: TCP
              port: 6443  # Kubernetes API
            - protocol: TCP
              port: 443   # HTTPS (AWS Secrets Manager)
            - protocol: TCP
              port: 5353    # DNS
            - protocol: UDP
              port: 5353    # DNS

